# Block commits to main branch
branch=$(git branch --show-current)
if [ "$branch" = "main" ]; then
  echo "âŒ Cannot commit directly to main. Create a feature branch first."
  echo "   Run: git checkout -b feature/your-feature-name"
  exit 1
fi

# Check for secrets/API keys in staged files
echo "ğŸ” Checking for secrets..."
gitleaks protect --staged --no-banner
if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ Secrets detected! Remove them before committing."
  echo "   If this is a false positive, add it to .gitleaksignore"
  exit 1
fi

pnpm run lint
pnpm run type-check
